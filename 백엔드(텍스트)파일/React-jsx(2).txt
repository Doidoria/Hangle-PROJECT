/* header.jsx */
import '../css/header.scss'
import { SearchBox, ThemeToggle, HeaderButtons, Profilebtn} from '../components/header-btn'

const Header = () => {

  return (
    <header className="topbar" aria-label="ìƒë‹¨ë°”">
      <SearchBox />
      <div className="top-actions">
        <ThemeToggle />
        <HeaderButtons/>
        <Profilebtn/>
      </div>
    </header>
  )
}
export default Header

/* aside.jsx */
import '../css/aside.scss'
import { Link } from 'react-router-dom';
import { useAuth } from '../api/AuthContext';

const Aside = () => {
    const { role, isLoading } = useAuth();
    if (isLoading) return null;

    const userRole = role?.toUpperCase();

    // ì¼ë°˜ USER ë©”ë‰´
    const UserMenu = () => (
        <>
            <Link to="/competitions/user" className="nav-create active">
                <img src="/image/+.png" alt="ì°¸ì—¬" style={{ width: 14 }} />
                ëŒ€íšŒ ì°¸ì—¬
            </Link>

            <nav className="nav-group">
                <Link to="/mydata" className="nav-item">
                    <span className="material-symbols-outlined">dataset</span>
                    <span>ë§ˆì´ë°ì´í„°</span>
                </Link>
            </nav>

            <nav className="nav-group">
                <Link to="/leaderboard" className="nav-item">
                    <span className="material-symbols-outlined">trophy</span>
                    <span>ë¦¬ë”ë³´ë“œ</span>
                </Link>
            </nav>

            <nav className="nav-group">
                <Link to="/FaqPage" className="nav-item">
                    <span className="material-symbols-outlined">support_agent</span>
                    <span>ê³ ê°ì„¼í„°</span>
                </Link>
            </nav>
        </>
    );

    // ë§¤ë‹ˆì € ë©”ë‰´ â€” (ìœ ì € ë©”ë‰´ í¬í•¨ X)
    const ManagerMenu = () => (
        <>
            <Link to="/competitions/user" className="nav-create active">
                <img src="/image/+.png" alt="ê´€ë¦¬" style={{ width: 14 }} />
                ëŒ€íšŒ ì°¸ì—¬
            </Link>
            <nav className="nav-group">
                <Link to="/competitions/new" className="nav-item">
                    <span className="material-symbols-outlined">add_circle</span>
                    <span>ëŒ€íšŒ ìƒì„±</span>
                </Link>
            </nav>
            <nav className="nav-group">
                <Link to="/competitions/list" className="nav-item">
                    <span className="material-symbols-outlined">list</span>
                    <span>ëŒ€íšŒ ì „ì²´ ê´€ë¦¬</span>
                </Link>
            </nav>
            <nav className="nav-group">
                <Link to="/leaderboard" className="nav-item">
                    <span className="material-symbols-outlined">trophy</span>
                    <span>ë¦¬ë”ë³´ë“œ</span>
                </Link>
            </nav>
            <nav className="nav-group">
                <Link to="/admin/inquiries" className="nav-item">
                    <span className="material-symbols-outlined">admin_panel_settings</span>
                    <span>1:1 ë¬¸ì˜ ê´€ë¦¬</span>
                </Link>
            </nav>
        </>
    );

    // ê´€ë¦¬ì ë©”ë‰´ â€” (ìœ ì € ë©”ë‰´ í¬í•¨ X)
    const AdminMenu = () => (
        <>
            <Link to="/competitions/user" className="nav-create active">
                <img src="/image/+.png" alt="ê´€ë¦¬" style={{ width: 14 }} />
                ëŒ€íšŒ ì°¸ì—¬
            </Link>
            <nav className="nav-group">
                <Link to="/competitions/new" className="nav-item">
                    <span className="material-symbols-outlined">add_circle</span>
                    <span>ëŒ€íšŒ ìƒì„±</span>
                </Link>
            </nav>
            <nav className="nav-group">
                <Link to="/competitions/list" className="nav-item">
                    <span className="material-symbols-outlined">list</span>
                    <span>ëŒ€íšŒ ì „ì²´ ê´€ë¦¬</span>
                </Link>
            </nav>
            <nav className="nav-group">
                <Link to="/leaderboard" className="nav-item">
                    <span className="material-symbols-outlined">trophy</span>
                    <span>ë¦¬ë”ë³´ë“œ</span>
                </Link>
            </nav>
            <nav className="nav-group">
                <Link to="/admin/inquiries" className="nav-item">
                    <span className="material-symbols-outlined">admin_panel_settings</span>
                    <span>1:1 ë¬¸ì˜ ê´€ë¦¬</span>
                </Link>
            </nav>
        </>
    );

    return (
        <aside className="sidebar" aria-label="ì™¼ìª½ ë‚´ë¹„ê²Œì´ì…˜">
            <Link to="/" className="logo" aria-label="ë©”ì¸ ì´ë™">
                <span className="dot" aria-hidden="true" />
                <span className="name">Hangle</span>
            </Link>

            {/* ê¶Œí•œë³„ë¡œ ì™„ì „íˆ ë¶„ë¦¬ ì¶œë ¥ */}
            {{
                'ROLE_ADMIN': <AdminMenu />,
                'ROLE_MANAGER': <ManagerMenu />,
                'ROLE_USER': <UserMenu />
            }[userRole] || <UserMenu />}
        </aside>
    );
};

export default Aside;


/* Competition.jsx */
import { useEffect, useState } from "react";
import { useNavigate } from "react-router-dom";
import api from "../api/axiosConfig";
import "../css/Competition.scss";

const API_BASE_URL = api.defaults.baseURL || "";

const Competition = () => {
  const navigate = useNavigate();

  const [competitions, setCompetitions] = useState([]);
  const [loading, setLoading] = useState(true);
  const [errorMsg, setErrorMsg] = useState("");
  const [files, setFiles] = useState({}); // ê° ëŒ€íšŒë³„ ì—…ë¡œë“œ íŒŒì¼

  useEffect(() => {
    const fetchCompetitions = async () => {
      try {
        const res = await api.get("/api/competitions", {
          params: { status: "OPEN", page: 0, size: 12 },
        });

        const data = res.data;
        let list = [];

        if (Array.isArray(data)) list = data;
        else if (Array.isArray(data?.content)) list = data.content;
        else if (Array.isArray(data?.items)) list = data.items;

        if (!list.length) {
          setErrorMsg("í˜„ì¬ ì§„í–‰ ì¤‘ì¸ ëŒ€íšŒê°€ ì—†ìŠµë‹ˆë‹¤.");
        } else {
          setCompetitions(list);
        }
      } catch (e) {
        console.error("[ëŒ€íšŒ ì¡°íšŒ ì˜¤ë¥˜]", e);
        setErrorMsg("ëŒ€íšŒ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.");
      } finally {
        setLoading(false);
      }
    };

    fetchCompetitions();
  }, []);

  const handleFileChange = (competitionId, e) => {
    const file = e.target.files?.[0];
    if (!file) return;

    setFiles((prev) => ({
      ...prev,
      [competitionId]: file,
    }));
  };

  const downloadFile = async (saveId, fileName) => {
    try {
      const res = await api.get(`/api/competitions/csv/${saveId}/download`, {
        responseType: "blob",
      });

      // Blob ìƒì„±
      const blob = new Blob([res.data], { type: "text/csv" });
      const url = window.URL.createObjectURL(blob);

      // ê°€ì§œ ë§í¬ ìƒì„±
      const a = document.createElement("a");
      a.href = url;
      a.download = fileName;
      document.body.appendChild(a);
      a.click();
      a.remove();

      // URL í•´ì œ
      window.URL.revokeObjectURL(url);

    } catch (e) {
      console.error("[íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜]", e);
      alert("íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    }
  };

  const submitFile = async (competitionId) => {
    const file = files[competitionId];
    if (!file) {
      alert("CSV íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”.");
      return;
    }

    const isCsv = /\.csv$/i.test(file.name);
    const isUnder5MB = file.size <= 5 * 1024 * 1024;
    if (!isCsv) {
      alert("CSV íŒŒì¼ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
      return;
    }
    if (!isUnder5MB) {
      alert("íŒŒì¼ í¬ê¸°ëŠ” 5MB ì´í•˜ë§Œ í—ˆìš©ë©ë‹ˆë‹¤.");
      return;
    }

    try {
      const formData = new FormData();
      formData.append("file", file);

      // TODO: ì‹¤ì œ ë¡œê·¸ì¸ ìœ ì € idë¡œ êµì²´
      const userid = localStorage.getItem("userid") || "test_user";
      formData.append("userid", userid);

      await api.post(
        `/api/competitions/${competitionId}/submit`,
        formData,
        {
          headers: {
            "Content-Type": "multipart/form-data",
          },
        }
      );

      alert(`"${file.name}" ì œì¶œ ì™„ë£Œ! ì ìˆ˜ ê³„ì‚° ì¤‘ì…ë‹ˆë‹¤.`);
      window.location.reload(); // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ (ì œì¶œ ì‹œ ì°¸ê°€ì ë°”ë¡œ ë°˜ì˜ì„ ìœ„í•´ ì‚¬ìš©)

      // ì œì¶œ í›„ í•´ë‹¹ ëŒ€íšŒ íŒŒì¼ ì„ íƒ ìƒíƒœ ì´ˆê¸°í™” (ì„ íƒì‚¬í•­)
      setFiles((prev) => ({
        ...prev,
        [competitionId]: undefined,
      }));
    } catch (e) {
      console.error("[ì œì¶œ ì‹¤íŒ¨]", e);
      alert("ì œì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
    }
  };

  const Section = () => {
    if (loading) {
      return (
        <div className="competition-section">
          <div className="grid competition-list">
            <article className="card">
              <h3>ëŒ€íšŒ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</h3>
            </article>
          </div>
        </div>
      );
    }

    if (errorMsg) {
      return (
        <div className="competition-section">
          <div className="grid competition-list">
            <article className="card">
              <h3>ëŒ€íšŒ ì •ë³´</h3>
              <p className="muted">{errorMsg}</p>
            </article>
          </div>
        </div>
      );
    }

    return (
      <div className="competition-section">
        <div className="grid competition-list">
          {competitions.map((competition) => {
            const {
              id,
              title,
              purpose,
              startAt,
              endAt,
              status,
              prizeTotal,
              participantCount,
            } = competition;

            // ëŒ€íšŒ ìƒì„¸ API ê²°ê³¼ë¥¼ competition ë³€ìˆ˜ì— ë„£ì—ˆë‹¤ê³  ê°€ì •
            const trainId = competition.trainDatasetSaveId;
            const testId = competition.testDatasetSaveId;

            const selectedFile = files[id];

            return (
              <article key={id} className="card competition-card">
                {/* ìƒë‹¨: ì™¼ìª½ ì œëª©, ì˜¤ë¥¸ìª½ ìì„¸íˆ ë³´ê¸° */}
                <div className="card-top">
                  <div className="card-top-left">
                    <span className="card-title">ëŒ€íšŒ ì¹´ë“œ</span>
                    <h3>{title || "ëŒ€íšŒ ì œëª© ë¯¸ì •"}</h3>
                  </div>
                  <button
                    type="button"
                    className="btn btn-ghost"
                    onClick={() => navigate(`/competitions/${id}`)}
                  >
                    ìì„¸íˆ ë³´ê¸°
                  </button>
                </div>

                {/* ê°€ìš´ë°: 3ë“±ë¶„ ë ˆì´ì•„ì›ƒ */}
                <div className="card-main">
                  {/* 1) ëŒ€íšŒ ì •ë³´ */}
                  <div className="card-col card-info">
                    <h4>ëŒ€íšŒ ì •ë³´</h4>
                    <p className="muted">
                      {purpose || "ëŒ€íšŒ ì„¤ëª…ì´ ì—†ìŠµë‹ˆë‹¤."}
                    </p>
                    <ul className="meta-list">
                      <li>
                        ìƒíƒœ: <code>{status}</code>
                      </li>
                      <li>
                        ê¸°ê°„: {startAt} ~ {endAt}
                      </li>
                      <li>
                        ì°¸ê°€ì ìˆ˜: {participantCount ?? 0}ëª…
                      </li>
                      {prizeTotal && (
                        <li>ì´ ìƒê¸ˆ: {prizeTotal.toLocaleString()}ì›</li>
                      )}
                    </ul>
                  </div>

                  {/* 2) ë°ì´í„° ë‹¤ìš´ë¡œë“œ */}
                  <div className="card-col card-download">
                    <h4>ë°ì´í„° ë‹¤ìš´ë¡œë“œ</h4>
                    <p className="muted small">
                      Train / Test íŒŒì¼ì„ ë‚´ë ¤ë°›ì•„ ëª¨ë¸ì„ í•™ìŠµí•˜ì„¸ìš”.
                    </p>
                    <div className="download-links">
                      {/* <a
                        href={`${API_BASE_URL}/api/competitions/${id}/dataset/train`}
                        className="link"
                      >
                        train.csv ë‹¤ìš´ë¡œë“œ
                      </a>
                      <a
                        href={`${API_BASE_URL}/api/competitions/${id}/dataset/test`}
                        className="link"
                      >
                        test.csv ë‹¤ìš´ë¡œë“œ
                      </a> */}
                      <button
                        className="link"
                        onClick={() => downloadFile(trainId, "train.csv")}
                      >
                        train.csv ë‹¤ìš´ë¡œë“œ
                      </button>

                      <button
                        className="link"
                        onClick={() => downloadFile(testId, "test.csv")}
                      >
                        test.csv ë‹¤ìš´ë¡œë“œ
                      </button>
                    </div>
                  </div>

                  {/* 3) ê²°ê³¼ ì œì¶œ (ì„¤ëª…ë§Œ) */}
                  <div className="card-col card-submit">
                    <h4>ê²°ê³¼ ì œì¶œ</h4>
                    <p className="muted small">
                      ì˜ˆì¸¡ ê²°ê³¼ CSVë¥¼ ì—…ë¡œë“œí•˜ë©´ ì ìˆ˜ê°€ ìë™ ê³„ì‚°ëœë‹¤ê³ 
                      ê°€ì •í•©ë‹ˆë‹¤.
                    </p>
                  </div>
                </div>

                {/* í•˜ë‹¨: íŒŒì¼ ì„ íƒ + ì œì¶œí•˜ê¸° */}
                <div className="card-bottom">
                  {/* ì‹¤ì œ íŒŒì¼ ì¸í’‹ì€ ìˆ¨ê¹€ */}
                  <input
                    id={`csv-input-${id}`}
                    type="file"
                    accept=".csv,text/csv"
                    style={{ display: "none" }}
                    aria-label={`ëŒ€íšŒ ${id} ì˜ˆì¸¡ ê²°ê³¼ CSV ì—…ë¡œë“œ`}
                    onChange={(e) => handleFileChange(id, e)}
                  />

                  {/* íŒŒì¼ ì„ íƒ ë²„íŠ¼ (labelì´ inputì„ ëŒ€ì‹  í´ë¦­) */}
                  <label
                    htmlFor={`csv-input-${id}`}
                    className="btn btn-outline"
                    style={{ marginRight: "8px", cursor: "pointer" }}
                  >
                    íŒŒì¼ ì„ íƒ
                  </label>

                  {/* ì„ íƒëœ íŒŒì¼ëª… í‘œì‹œ */}
                  <span className="file-name muted" style={{ marginRight: "auto" }}>
                    {selectedFile
                      ? `ì„ íƒëœ íŒŒì¼: ${selectedFile.name}`
                      : 'ì œì¶œ CSV ì»¬ëŸ¼ëª…ì€ ë°˜ë“œì‹œ ( label )í•´ì£¼ì„¸ìš”.'}
                  </span>

                  {/* ì œì¶œ ë²„íŠ¼ */}
                  <button
                    type="button"
                    className="btn"
                    onClick={() => submitFile(id)}
                    disabled={!selectedFile}
                  >
                    ì œì¶œí•˜ê¸°
                  </button>
                </div>
              </article>
            );
          })}
        </div>
      </div>
    );
  };

  return (
    <section className="section-wrap">
      <div className="competition-title">
        <div>
          <h1>ëŒ€íšŒ ì°¸ì—¬</h1>
          <p>ë‹¤ì–‘í•œ ëŒ€íšŒì— ì°¸ì—¬í•´ë³´ì„¸ìš”!</p>
        </div>
      </div>
      <Section />
    </section>
  );
};

export default Competition;



/* CompetitionCreate.jsx */
// src/pages/CompetitionCreate.jsx
// src/pages/CompetitionCreate.jsx
import { useState } from 'react';
import { useNavigate, Link } from 'react-router-dom';
import api from '../api/axiosConfig';
import AutoCompetitionButton from '../components/CreateAllCompetitions';

// CompetitionCreate.jsx
import "../css/Competition.scss";
import "../css/CompetitionCreate.scss";

function CompetitionCreate() {
  const navigate = useNavigate();
  const [form, setForm] = useState({
    title: '',
    description: '',        // ëª©ì (í•œ ì¤„) -> backend purpose
    detail: '',             // âœ… ìƒì„¸ ì„¤ëª…
    startAt: '',            // "YYYY-MM-DDTHH:mm"
    endAt: '',
    evaluationMetric: 'ACCURACY', // âœ… ê¸°ë³¸ê°’
    prizeTotal: '',         // âœ… ìˆ«ì ì…ë ¥
    // í™”ë©´ì—” ì•ˆ ë³´ì—¬ë„ ì „ì†¡ì€ í•´ì•¼ í•¨(ë°±ì—”ë“œ @NotNull): 
    status: 'UPCOMING',
  });

  // CSV íŒŒì¼ ìƒíƒœ
  const [trainFile, setTrainFile] = useState(null);
  const [testFile, setTestFile] = useState(null);

  const [saving, setSaving] = useState(false);
  const [errorMsg, setErrorMsg] = useState('');

  const onChange = (e) => {
    const { name, value } = e.target;
    setForm(f => ({ ...f, [name]: value }));
  };

  const normDT = (v) => (v ? (v.length === 16 ? `${v}:00` : v) : null);

  const validate = () => {
    if (!form.title.trim()) return 'ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
    if (!form.description.trim()) return 'ëª©ì ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
    if (!form.startAt || !form.endAt) return 'ì‹œì‘ì¼ê³¼ ì¢…ë£Œì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
    if (form.endAt < form.startAt) return 'ì¢…ë£Œì¼ì€ ì‹œì‘ì¼ ì´í›„ì—¬ì•¼ í•©ë‹ˆë‹¤.';
    if (form.prizeTotal && Number.isNaN(Number(form.prizeTotal))) return 'ìƒê¸ˆì€ ìˆ«ìë§Œ ì…ë ¥í•´ì£¼ì„¸ìš”.';
    // íŒŒì¼ ì—…ë¡œë“œ ê²€ì¦
    if (!trainFile) return 'train.csv íŒŒì¼ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.';
    if (!testFile) return 'test.csv íŒŒì¼ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.';
    return null;
  };

  const onSubmit = async (e) => {
    e.preventDefault();
    if (saving) return;
    setErrorMsg('');
    const v = validate();
    if (v) { setErrorMsg(v); return; }

    try {
      setSaving(true);
      const payload = {
        title: form.title.trim(),
        description: form.description?.trim() || null,
        detail: form.detail?.trim() || null,               // âœ… ìƒì„¸ ì„¤ëª…
        status: 'UPCOMING',                                 // ìˆ¨ê¹€ ê¸°ë³¸ê°’
        startAt: normDT(form.startAt),
        endAt: normDT(form.endAt),
        evaluationMetric: form.evaluationMetric || 'ACCURACY',  // âœ…
        prizeTotal: form.prizeTotal ? Number(form.prizeTotal) : null // âœ… ìˆ«ìë¡œ
      };
      // íŒŒì¼ ë³´ë‚´ê¸° ìœ„í•œ í¼ë°ì´í„° ìƒì„±
      const fd = new FormData();

      // JSONì„ Blobìœ¼ë¡œ ê°ì‹¸ì„œ request íŒŒíŠ¸ë¡œ ì „ì†¡
      fd.append(
        "request",
        new Blob([JSON.stringify(payload)], { type: "application/json" })
      );

      // íŒŒì¼ ì „ì†¡
      fd.append("trainFile", trainFile);
      fd.append("testFile", testFile);

      // baseURLì´ /apië¥¼ í¬í•¨í•œë‹¤ë©´ ì•„ë˜ ê²½ë¡œëŠ” '/competitions'ë¡œ ë°”ê¿”ì£¼ì„¸ìš”.
      const { data: created } = await api.post('/api/competitions', fd, {
        // headers: { 'Content-Type': 'application/json' },
        headers: { 'Content-Type': 'multipart/form-data' },
      });

      alert(`ëŒ€íšŒê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤! (ID: ${created.id})`);
      navigate(`/competitions/${created.id}`, { replace: true });
    } catch (err) {
      console.error(err);
      if (err.code === 'ERR_NETWORK') return setErrorMsg('ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜)');
      const msg = err.response?.data?.message || err.response?.data?.error ||
        `ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (HTTP ${err.response?.status ?? '???'})`;
      setErrorMsg(msg);
    } finally {
      setSaving(false);
    }
  };

  return (
    <div className="container comp-create">
      <Link className="back" to="/competitions/List">â† ëª©ë¡ìœ¼ë¡œ</Link>
      <h1>ëŒ€íšŒ ìƒì„±</h1>

      <form onSubmit={onSubmit} noValidate>
        <label>
          ì œëª©
          <input name="title" value={form.title} onChange={onChange} required placeholder="ëŒ€íšŒ ì œëª©" />
        </label>

        <label>
          ëª©ì (í•œ ì¤„)
          <input name="description" value={form.description} onChange={onChange} required placeholder="ì˜ˆ) ê³ ì–‘ì´/ê°•ì•„ì§€ ë¶„ë¥˜ ëª¨ë¸ ê°œë°œ" />
        </label>

        <label>
          ìƒì„¸ ì„¤ëª…
          <textarea name="detail" value={form.detail} onChange={onChange} rows={8} placeholder="ëŒ€íšŒì˜ ìƒì„¸ ëª©í‘œ/ë°ì´í„° ì„¤ëª…/ì œì¶œ í˜•ì‹ ë“±" />
        </label>

        <div className="row">
          <label>
            ì‹œì‘ì¼
            <input type="datetime-local" name="startAt" value={form.startAt} onChange={onChange} required />
          </label>
          <label>
            ì¢…ë£Œì¼
            <input type="datetime-local" name="endAt" value={form.endAt} onChange={onChange} min={form.startAt || undefined} required />
          </label>
        </div>

        <label>
          í‰ê°€ ì§€í‘œ
          <select name="evaluationMetric" value={form.evaluationMetric} onChange={onChange}>
            <option value="ACCURACY">ACCURACY</option>
            <option value="F1">F1</option>
            <option value="AUC">AUC</option>
            <option value="RMSE">RMSE</option>
            <option value="MAE">MAE</option>
          </select>
        </label>

        <label>
          ìƒê¸ˆ
          <input type="number" step="0.01" name="prizeTotal" value={form.prizeTotal} onChange={onChange} placeholder="ì˜ˆ: 1000000" />
        </label>

        {/* CSV íŒŒì¼ ì—…ë¡œë“œ */}
        <label>
          Train CSV ì—…ë¡œë“œ
          <input type="file" accept=".csv" onChange={(e) => setTrainFile(e.target.files[0])} />
        </label>
        <label>
          Test CSV ì—…ë¡œë“œ
          <input type="file" accept=".csv" onChange={(e) => setTestFile(e.target.files[0])} />
        </label>

        {errorMsg && <div className="error">{errorMsg}</div>}

        <div className="actions">
          <button type="submit" className="primary" disabled={saving}>
            {saving ? 'ì €ì¥ ì¤‘...' : 'ì €ì¥'}
          </button>
          <button type="button" onClick={() => navigate('/competitions')} disabled={saving}>
            ì·¨ì†Œ
          </button>
          <AutoCompetitionButton />
        </div>
      </form>
    </div>
  );
}

export default CompetitionCreate;


/* CompetitionDetail.jsx */
import { useEffect, useMemo, useState } from 'react';
import { useParams, Link } from 'react-router-dom';
import api from '../api/axiosConfig';

// CompetitionDetail.jsx
import "../css/Competition.scss";
import "../css/CompetitionDetail.scss";

export default function CompetitionDetail() {
  const { id } = useParams();
  const [comp, setComp] = useState(null);
  const [state, setState] = useState({ loading: false, error: null });

  useEffect(() => {
    (async () => {
      setState({ loading: true, error: null });
      try {
        const res = await api.get(`/api/competitions/${id}`);
        setComp(res.data);
        setState({ loading: false, error: null });
      } catch (e) {
        // ì‹¤íŒ¨ ì‹œ ì˜ˆì‹œ ë°ì´í„°ë¡œ ì±„ì›Œì„œ í™”ë©´ì€ ìœ ì§€
        setComp({
          id,
          title: 'ì˜ˆì‹œ ëŒ€íšŒ',
          status: 'OPEN',
          startAt: '2025-11-01',
          endAt: '2025-12-01',
          prize: 'ì´ìƒê¸ˆ 100ë§Œì›',
          summary: 'ì˜ˆì‹œ ìš”ì•½ì…ë‹ˆë‹¤.',
          description: 'ì˜ˆì‹œ ì„¤ëª…ì…ë‹ˆë‹¤.',
          datasetUrl: '#',
          rulesUrl: '#',
        });
        setState({
          loading: false,
          error:
            e.response?.status === 404
              ? 'ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ëŒ€íšŒì…ë‹ˆë‹¤.'
              : e.message || 'ìš”ì²­ ì‹¤íŒ¨',
        });
      }
    })();
  }, [id]);

  const fmtDate = (d) => (typeof d === 'string' ? d.slice(0, 10) : d);

  const daysLeft = useMemo(() => {
    if (!comp?.endAt) return null;
    const end = new Date(comp.endAt);
    const diff = Math.ceil((end - new Date()) / (1000 * 60 * 60 * 24));
    return diff;
  }, [comp?.endAt]);

  if (state.loading) return <div style={{ padding: 24 }}>ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>;
  if (!comp) return <div style={{ padding: 24 }}>ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>;

  return (
    <div className="container comp-detail">
      <Link className="back" to="/competitions/user">
        â† ëª©ë¡ìœ¼ë¡œ
      </Link>
      {state.error && (
        <div style={{ marginTop: 12, color: '#b91c1c' }}>{state.error}</div>
      )}

      {/* ìƒë‹¨ ì •ë³´ */}
      <section className="hero">
        <h1>{comp.title}</h1>
        <div className="meta">
          ìƒíƒœ:&nbsp;
          <span className="badge">{comp.status}</span> | ê¸°ê°„:{' '}
          {fmtDate(comp.startAt)} ~ {fmtDate(comp.endAt)}
        </div>
        {comp.summary && (
          <p className="muted" style={{ marginTop: 6 }}>
            {comp.summary}
          </p>
        )}
        {comp.prize && <div className="prize">ìƒê¸ˆ: {comp.prize}</div>}

        <div className="links">
          {comp.datasetUrl && (
            <a
              href={comp.datasetUrl}
              target="_blank"
              rel="noreferrer"
              className="btn"
            >
              ë°ì´í„°ì…‹
            </a>
          )}
          {comp.rulesUrl && (
            <a
              href={comp.rulesUrl}
              target="_blank"
              rel="noreferrer"
              className="btn"
            >
              ê·œì¹™
            </a>
          )}
        </div>
      </section>

      {/* ì„¸ë¶€ ì¹´ë“œë“¤ */}
      <div className="detail-cards">
        <article className="wide-card">
          <h3>ğŸ“… ì§„í–‰ ì •ë³´</h3>
          <div className="card-content">
            <p>
              <strong>ìƒíƒœ:</strong> {comp.status}
            </p>
            <p>
              <strong>ê¸°ê°„:</strong> {fmtDate(comp.startAt)} ~{' '}
              {fmtDate(comp.endAt)}
            </p>
            <p>
              <strong>ë‚¨ì€ ê¸°ê°„:</strong>{' '}
              {daysLeft === null
                ? '-'
                : daysLeft >= 0
                  ? `${daysLeft}ì¼ ë‚¨ìŒ`
                  : `ë§ˆê° (${Math.abs(daysLeft)}ì¼ ê²½ê³¼)`}
            </p>
          </div>
        </article>

        <article className="wide-card">
          <h3>ğŸ§¾ ê¸°ë³¸ ì •ë³´</h3>
          <div className="card-content">
            <p>
              <strong>ì œëª©:</strong> {comp.title}
            </p>
            <p>
              <strong>ìš”ì•½:</strong> {comp.summary || 'â€”'}
            </p>
            <p>
              <strong>ID:</strong> {comp.id}
            </p>
          </div>
        </article>

        <article className="wide-card">
          <h3>ğŸ’° ë³´ìƒ ì •ë³´</h3>
          <div className="card-content">
            <p>
              <strong>ìƒê¸ˆ:</strong> {comp.prize || 'í‘œê¸°ëœ ìƒê¸ˆ ì—†ìŒ'}
            </p>
            <p className="muted">
              ìš°ìŠ¹ì ë° ìƒìœ„ê¶Œ ì°¸ê°€ìì—ê²Œ ì œê³µë˜ëŠ” ë³´ìƒ ì •ë³´ë¥¼ í‘œì‹œí•˜ì„¸ìš”.
            </p>
          </div>
        </article>

        <article className="wide-card">
          <h3>ğŸ”— ì°¸ê³  ë§í¬</h3>
          <div className="card-content">
            <p>
              ë°ì´í„°ì…‹:{' '}
              {comp.datasetUrl ? (
                <a href={comp.datasetUrl} target="_blank" rel="noreferrer">
                  ì—´ê¸°
                </a>
              ) : (
                <span className="muted">ì—†ìŒ</span>
              )}
            </p>
            <p>
              ê·œì¹™:{' '}
              {comp.rulesUrl ? (
                <a href={comp.rulesUrl} target="_blank" rel="noreferrer">
                  ì—´ê¸°
                </a>
              ) : (
                <span className="muted">ì—†ìŒ</span>
              )}
            </p>
          </div>
        </article>


      </div>

      {/* ìƒì„¸ ì„¤ëª… */}
      <section className="desc">
        <h3>ğŸ“ ëŒ€íšŒ ì„¤ëª…</h3>
        <p>{comp.description || 'ì„¤ëª…ì´ ì—†ìŠµë‹ˆë‹¤.'}</p>
      </section>
    </div>
  );
}


/* CompetitionList.jsx */
import { useEffect, useMemo, useState } from 'react';
import { Link, useSearchParams, useNavigate } from 'react-router-dom';
import api from '../api/axiosConfig';

// CompetitionList.jsx
import "../css/Competition.scss";
import "../css/CompetitionList.scss";

function fmtDT(v) {
  if (!v) return '-';
  // "2025-12-01T18:00:00" â†’ "2025-12-01 18:00"
  return v.replace('T', ' ').slice(0, 16);
}

export default function CompetitionList() {
  const [searchParams, setSearchParams] = useSearchParams();
  const navigate = useNavigate();

  // URL ì¿¼ë¦¬ â†” ìƒíƒœ
  const status = searchParams.get('status') || '';
  const keyword = searchParams.get('keyword') || '';
  const page = Number(searchParams.get('page') || 0);
  const size = Number(searchParams.get('size') || 12);

  const [loading, setLoading] = useState(false);
  const [errorMsg, setErrorMsg] = useState('');
  const [data, setData] = useState({ content: [], totalPages: 0, number: 0, totalElements: 0 });

  const params = useMemo(() => {
    const p = { page, size };
    if (status) p.status = status; // UPCOMING | OPEN | CLOSED
    if (keyword.trim()) p.keyword = keyword.trim();
    return p;
  }, [status, keyword, page, size]);

  useEffect(() => {
    (async () => {
      try {
        setLoading(true);
        setErrorMsg('');
        // NOTE: axiosConfig.baseURLì´ http://localhost:8090 ë¼ë©´ ê²½ë¡œì— /api í¬í•¨í•´ì•¼ í•¨
        const res = await api.get('/api/competitions', { params });
        setData(res.data);
      } catch (err) {
        console.error(err);
        setErrorMsg('ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.');
      } finally {
        setLoading(false);
      }
    })();
  }, [params]);

  const onSearch = (e) => {
    e.preventDefault();
    const fd = new FormData(e.currentTarget);
    const next = new URLSearchParams(searchParams);
    next.set('page', '0'); // ìƒˆ ê²€ìƒ‰ì€ ì²« í˜ì´ì§€ë¶€í„°
    next.set('size', String(size));
    next.set('status', fd.get('status') || '');
    next.set('keyword', fd.get('keyword') || '');
    setSearchParams(next);
  };

  const movePage = (nextPage) => {
    const next = new URLSearchParams(searchParams);
    next.set('page', String(nextPage));
    setSearchParams(next);
  };

  return (
    <section className="container" style={{padding:'16px'}}>
      <div style={{display:'flex', justifyContent:'space-between', alignItems:'center', marginBottom:12}}>
        <h1 style={{margin:0}}>ëŒ€íšŒ ëª©ë¡</h1>
        <Link className="button" to="/competitions/new">ëŒ€íšŒ ìƒì„±</Link>
      </div>

      {/* ê²€ìƒ‰/í•„í„° */}
      <form onSubmit={onSearch} style={{display:'grid', gap:8, gridTemplateColumns:'150px 1fr 120px', marginBottom:12}}>
        <select name="status" defaultValue={status}>
          <option value="">ìƒíƒœ(ì „ì²´)</option>
          <option value="UPCOMING">UPCOMING</option>
          <option value="OPEN">OPEN</option>
          <option value="CLOSED">CLOSED</option>
        </select>
        <input name="keyword" defaultValue={keyword} placeholder="ì œëª© ê²€ìƒ‰" />
        <button type="submit">ê²€ìƒ‰</button>
      </form>

      {/* ì—ëŸ¬/ë¡œë”© */}
      {errorMsg && <div style={{color:'#c00', marginBottom:8}}>{errorMsg}</div>}
      {loading && <div style={{marginBottom:8}}>ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘â€¦</div>}

      {/* ëª©ë¡ */}
      <div style={{overflowX:'auto', border:'1px solid var(--border, #e5e7eb)', borderRadius:8}}>
        <table style={{width:'100%', borderCollapse:'collapse'}}>
          <thead style={{background:'var(--surface, #f9fafb)'}}>
            <tr>
              <th style={th}>ID</th>
              <th style={th}>ì œëª©</th>
              <th style={th}>ëª©ì </th>
              <th style={th}>ìƒíƒœ</th>
              <th style={th}>ì‹œì‘</th>
              <th style={th}>ì¢…ë£Œ</th>
              <th style={th}>ì§€í‘œ</th>
              <th style={th}>ìƒê¸ˆ</th>
              <th style={th}>ì°¸ê°€ì</th>
              <th style={th}></th>
            </tr>
          </thead>
          <tbody>
            {data.content.length === 0 && !loading && (
              <tr><td colSpan={10} style={{textAlign:'center', padding:'16px'}}>ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>
            )}
            {data.content.map((it) => (
              <tr key={it.id} style={{borderTop:'1px solid var(--border, #e5e7eb)'}}>
                <td style={td}>{it.id}</td>
                <td style={td}>{it.title}</td>
                <td style={td}>{it.purpose || '-'}</td>
                <td style={td}>{it.status}</td>
                <td style={td}>{fmtDT(it.startAt)}</td>
                <td style={td}>{fmtDT(it.endAt)}</td>
                <td style={td}>{it.evaluationMetric || '-'}</td>
                <td style={td}>{it.prizeTotal != null ? Number(it.prizeTotal).toLocaleString() : '-'}</td>
                <td style={td}>{it.participantCount ?? 0}</td>
                <td style={td}>
                  <Link to={`/competitions/${it.id}`}>ìƒì„¸</Link>
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>

      {/* í˜ì´ì§€ë„¤ì´ì…˜ */}
      <div style={{display:'flex', gap:8, justifyContent:'center', marginTop:12}}>
        <button disabled={page <= 0} onClick={() => movePage(page - 1)}>ì´ì „</button>
        <span>Page {page + 1} / {Math.max(data.totalPages, 1)}</span>
        <button disabled={page + 1 >= data.totalPages} onClick={() => movePage(page + 1)}>ë‹¤ìŒ</button>
      </div>
    </section>
  );
}

const th = { textAlign:'left', padding:'10px 12px', fontWeight:700, fontSize:14 };
const td = { padding:'10px 12px', fontSize:14 };


/* FaqPage.jsx */
import React, { useState, useRef, useEffect } from "react";
import { useNavigate } from "react-router-dom";
import "../css/FaqPage.scss";

// ì§ˆë¬¸ ëª©ë¡
const faqData = [
    { id: 1, category: "íšŒì›", question: "íšŒì›ê°€ì…ì€ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?", answer: "ë¡œê·¸ì¸ í˜ì´ì§€ í•˜ë‹¨ì˜ 'íšŒì›ê°€ì…'ì„ í†µí•´ ê°€ì…í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤." },
    { id: 2, category: "íšŒì›", question: "ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì€ ì–´ë–»ê²Œ í•˜ë‚˜ìš”?", answer: "ë§ˆì´í˜ì´ì§€ ìƒë‹¨ì˜ 'ì„¤ì •'ì„ í†µí•´ ë³€ê²½í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤." },
    { id: 3, category: "ì„œë¹„ìŠ¤", question: "ì‘ì„±í•œ ë¬¸ì˜ëŠ” ì–´ë””ì„œ í™•ì¸í•˜ë‚˜ìš”?", answer: "í˜„ì¬ í˜ì´ì§€ í•˜ë‹¨ì˜ 'ë‚˜ì˜ ë¬¸ì˜ ëª©ë¡'ì„ í†µí•´ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤." },
    { id: 4, category: "ì„œë¹„ìŠ¤", question: "ë‹µë³€ì€ ì–¼ë§ˆë‚˜ ê±¸ë¦¬ë‚˜ìš”?", answer: "í‰ê· ì ìœ¼ë¡œ 1~3 ì˜ì—…ì¼ ì´ë‚´ì— ë‹µë³€ë“œë¦½ë‹ˆë‹¤." },
    { id: 5, category: "ì„œë¹„ìŠ¤", question: "ê³ ê°ì„¼í„° ì´ìš©ì‹œê°„ì€ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?", answer: "ê³ ê°ì„¼í„°ëŠ” í‰ì¼ ì˜¤ì „ 9ì‹œë¶€í„° ì˜¤í›„ 6ì‹œê¹Œì§€ ìš´ì˜ë©ë‹ˆë‹¤." },
    { id: 6, category: "ê¸°íƒ€", question: "ì ì‹¬ë©”ë‰´ ì¶”ì²œ í•´ì£¼ì„¸ìš”", answer: "ìˆœëŒ€êµ­ë°¥Â·ë¼ˆí•´ì¥êµ­Â·ì½©ë‚˜ë¬¼êµ­ë°¥Â·ê¹€ì¹˜ì°Œê°œÂ·ëœì¥ì°Œê°œÂ·ë¶€ëŒ€ì°Œê°œÂ·ê¹€ë°¥Â·ë¼ë©´Â·ë–¡ë³¶ì´Â·ìˆœëŒ€Â·íŠ€ê¹€Â·ì–´ë¬µÂ·ëˆê¹ŒìŠ¤Â·ì¹´ë ˆ" },
    { id: 7, category: "ê¸°íƒ€", question: "ìˆ˜ë£Œë‚ ì§œëŠ” ì–´ë–»ê²Œ ë˜ë‚˜ìš”?", answer: "ìˆ˜ë£Œ ë‚ ì§œëŠ” 2025.12.05 ì…ë‹ˆë‹¤." },
];

function FaqPage() {
    const navigate = useNavigate();
    const [openId, setOpenId] = useState(null);
    const [selectedCategory, setSelectedCategory] = useState("ì „ì²´");
    const [searchTerm, setSearchTerm] = useState("");

    const categories = ["ì „ì²´", "íšŒì›", "ì„œë¹„ìŠ¤", "ê¸°íƒ€"];

    const toggleFaq = (id) => {
        setOpenId(openId === id ? null : id);
    };

    const filteredFaqs = faqData.filter((faq) => {
        const matchCategory = selectedCategory === "ì „ì²´" || faq.category === selectedCategory;
        const matchSearch = faq.question.toLowerCase().includes(searchTerm.toLowerCase());
        return matchCategory && matchSearch;
    });

    const topFaqs = faqData.slice(0, 5);

    return (
        <div className="faq-container">
            <h2 className="faq-title">ê³ ê°ì„¼í„° (FAQ)</h2>

            <div className="faq-controls">
                <input
                    type="text"
                    placeholder="ê¶ê¸ˆí•œ ë‚´ìš©ì„ ê²€ìƒ‰í•´ë³´ì„¸ìš”."
                    value={searchTerm}
                    onChange={(e) => setSearchTerm(e.target.value)}
                    className="faq-search"
                />
                <div className="faq-categories">
                    {categories.map((cat) => (
                        <button
                            key={cat}
                            className={selectedCategory === cat ? "active" : ""}
                            onClick={() => setSelectedCategory(cat)}
                        >
                            {cat}
                        </button>
                    ))}
                </div>
            </div>

            <div className="top-faqs">
                <h3>
                    <span className="material-symbols-outlined">brand_awareness</span>
                    ìì£¼ ë¬»ëŠ” ì§ˆë¬¸
                </h3>
                <ul>
                    {topFaqs.map((faq) => (
                        <li key={faq.id} onClick={() => setOpenId(faq.id)}>
                            {faq.question}
                        </li>
                    ))}
                </ul>
            </div>


            <div className="faq-list">
                {filteredFaqs.map((faq) => (
                    <FaqItem
                        key={faq.id}
                        faq={faq}
                        open={openId === faq.id}
                        onToggle={() => toggleFaq(faq.id)}
                    />
                ))}
            </div>

            <div className="faq-footer">
                <button onClick={() => navigate("/inquiry/write")}>
                    1:1 ë¬¸ì˜ ì‘ì„±í•˜ê¸°
                </button>

                <button onClick={() => navigate("/myprofile/inquiries")}>
                    ë‚˜ì˜ ë¬¸ì˜ ëª©ë¡
                </button>
            </div>

        </div>
    );
}

/* ê°œë³„ FAQ ì•„ì´í…œ (ì• ë‹ˆë©”ì´ì…˜ í¬í•¨) */
function FaqItem({ faq, open, onToggle }) {
    const contentRef = useRef(null);
    const [height, setHeight] = useState("0px");

    useEffect(() => {
        setHeight(open ? `${contentRef.current.scrollHeight}px` : "0px");
    }, [open]);

    return (
        <div className="faq-item">
            <div className="faq-question" onClick={onToggle}>
                {faq.question}
                <span>{open ? "â–²" : "â–¼"}</span>
            </div>
            <div
                ref={contentRef}
                className={`faq-answer-wrapper ${open ? "open" : ""}`}
                style={{ height }}
            >
                <div className="faq-answer">
                    <span className="material-symbols-outlined faq-icon">
                        brand_awareness
                    </span>
                    {faq.answer}
                </div>
            </div>
        </div>
    );
}

export default FaqPage;


/* footer.jsx */
import '../css/footer.scss'

const Footer = ()=>{
    return (
        <footer>
          <div className="footer-wrap">
            <div className="footer-grid">
              <div className="footer-col">
                <h4>íšŒì‚¬</h4>
                <a href="#">íšŒì‚¬ ì†Œê°œ</a>
                <a href="#">ì±„ìš©</a>
                <a href="#">ë³´ë„ìë£Œ</a>
              </div>
              <div className="footer-col">
                <h4>ì •ì±…</h4>
                <a href="#">ì´ìš©ì•½ê´€</a>
                <a href="#">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>
                <a href="#">ì¿ í‚¤ ì •ì±…</a>
              </div>
              <div className="footer-col">
                <h4>ì§€ì›</h4>
                <a href="#">ë„ì›€ë§ ì„¼í„°</a>
                <a href="#">ë¬¸ì˜í•˜ê¸°</a>
                <a href="#">ì‹ ê³ /í”¼ë“œë°±</a>
              </div>
              <div className="footer-col">
                <h4>ë¦¬ì†ŒìŠ¤</h4>
                <a href="#">ê°œë°œì ë¬¸ì„œ</a>
                <a href="#">API</a>
                <a href="#">ë¸Œëœë“œ ê°€ì´ë“œ</a>
              </div>
            </div>
            <div className="copyright">
              Â© <span id="year" /> hangle. ëª¨ë“  ê¶Œë¦¬ ë³´ìœ .
            </div>
          </div>
        </footer>
    )
}
export default Footer

